fetch(url)
  .then(response => {
    if (!response.ok) {
      throw new Error('Respuesta HTTP ' + response.status);
    }
    return response.json();
  })
  .then(data => {
    data.forEach(item => {
      if(item.lat && item.lon) {
        L.marker([parseFloat(item.lat), parseFloat(item.lon)])
          .addTo(map)
          .bindPopup(`<b>${item.nombre}</b><br>Lat: ${item.lat}<br>Lon: ${item.lon}`);
      }
    });
  })
  .catch(err => {
    alert("Error al cargar los datos del mapa: " + err.message);
    console.error(err);
  });
